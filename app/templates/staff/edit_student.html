{% extends "base.html" %}

{% block content %}
<div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">Detail Siswa: {{ student.full_name }}</h1>
    <a href="{{ url_for('staff.list_students') }}" class="btn btn-sm btn-secondary shadow-sm">
        <i class="fas fa-arrow-left fa-sm text-white-50 me-1"></i> Kembali
    </a>
</div>

<form method="POST">
    <div class="row">
        
        <div class="col-md-4 mb-4">
            
            <div class="card shadow mb-4">
                <div class="card-header py-3 bg-primary text-white">
                    <h6 class="m-0 fw-bold"><i class="fas fa-school me-2"></i>Data Akademik</h6>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="small fw-bold text-muted">Nama Lengkap</label>
                        <input type="text" name="full_name" class="form-control fw-bold" value="{{ student.full_name }}" required>
                    </div>
                    
                    <div class="mb-3">
                        <label class="small fw-bold text-muted">NIS</label>
                        <input type="text" class="form-control bg-light" value="{{ student.nis }}" readonly>
                        <small class="text-muted" style="font-size:10px;">*NIS tidak bisa diubah.</small>
                    </div>

                    <div class="mb-3">
                        <label class="small fw-bold text-muted">NISN (Nasional)</label>
                        <input type="text" name="nisn" class="form-control" value="{{ student.nisn or '' }}" placeholder="Belum ada">
                    </div>

                    <div class="mb-3">
                        <label class="small fw-bold text-muted">Kelas Saat Ini</label>
                        <select name="class_id" class="form-select border-primary">
                            <option value="">-- Belum Masuk Kelas --</option>
                            {% for c in classes %}
                                <option value="{{ c.id }}" {% if student.current_class_id == c.id %}selected{% endif %}>
                                    {{ c.name }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>

            <div class="card shadow border-left-warning">
                <div class="card-header py-3">
                    <h6 class="m-0 fw-bold text-warning"><i class="fas fa-money-bill-wave me-2"></i>Setting Keuangan</h6>
                </div>
                <div class="card-body bg-light">
                    <div class="mb-3">
                        <label class="fw-bold text-success small">Nominal SPP Khusus (Opsional)</label>
                        <div class="input-group">
                            <span class="input-group-text bg-success text-white">Rp</span>
                            <input type="number" name="custom_spp" class="form-control fw-bold text-success"
                                value="{{ student.custom_spp_fee or '' }}"
                                placeholder="0">
                        </div>
                        <small class="text-muted" style="font-size: 0.75rem;">
                            <i class="fas fa-info-circle"></i> Isi <b>hanya jika</b> SPP siswa ini beda dari tarif normal (Misal: Diskon Yatim).
                            Kosongkan jika ikut tarif umum.
                        </small>
                    </div>
                </div>
            </div>
        
        </div>

        <div class="col-md-8">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 fw-bold text-primary"><i class="fas fa-user-friends me-2"></i>Data Pribadi & Orang Tua</h6>
                </div>
                <div class="card-body">
                    
                    <h6 class="text-muted text-uppercase small fw-bold mb-3 border-bottom pb-2">Informasi Wali Murid</h6>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="small fw-bold">Nama Ayah</label>
                            <input type="text" class="form-control" value="{{ student.parent.full_name if student.parent else '-' }}" readonly>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="small fw-bold">No. WhatsApp</label>
                            <input type="text" class="form-control" value="{{ student.parent.phone if student.parent else '-' }}" readonly>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="small fw-bold">Alamat Rumah</label>
                        <textarea class="form-control" rows="2" readonly>{{ student.address or '-' }}</textarea>
                    </div>

                    <div class="alert alert-info py-2 small">
                        <i class="fas fa-exclamation-circle me-1"></i> 
                        Saat ini data Wali Murid diambil otomatis dari form PPDB. Jika ingin mengedit data Orang Tua secara spesifik, silakan gunakan menu "Data Wali Murid" (Coming Soon).
                    </div>

                    <hr>

                    <button type="submit" class="btn btn-primary fw-bold px-4">
                        <i class="fas fa-save me-2"></i> Simpan Perubahan
                    </button>
                    
                </div>
            </div>
        </div>

    </div>
</form>
{% endblock %}