<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Lampiran Nilai - {{ student.full_name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Times New Roman', serif; color: #000; }
        .table-bordered { border: 1px solid #000 !important; }
        .table-bordered th, .table-bordered td { border: 1px solid #000 !important; }

        /* --- KUNCI PERBAIKAN DI SINI --- */
        @media print {
            .no-print, .no-print * {
                display: none !important;
                visibility: hidden !important;
                height: 0 !important;
            }
            /* Hilangkan header/footer default browser jika mengganggu */
            @page {
                margin: 1cm;
                size: portrait;
            }
        }
    </style>
</head>
<body class="p-5">

    <div class="container">
        <div class="d-flex justify-content-between mb-4 no-print">
            <h4 class="fw-bold text-muted">LAMPIRAN TRANSKRIP NILAI</h4>
            <div>
                <button onclick="window.print()" class="btn btn-primary"><i class="fas fa-print me-2"></i>Cetak Lampiran</button>
                <button onclick="window.close()" class="btn btn-secondary ms-2">Tutup</button>
            </div>
        </div>

        <div class="border-bottom border-dark mb-4 pb-2">
            <h5 class="fw-bold mb-0">RINCIAN KOMPONEN NILAI</h5>
            <small>Nama: {{ student.full_name }} | Kelas: {{ student.current_class.name }}</small>
        </div>

        <table class="table table-bordered border-dark table-sm table-striped">
            <thead class="text-center bg-light">
                <tr>
                    <th rowspan="2" class="align-middle">No</th>
                    <th rowspan="2" class="align-middle">Mata Pelajaran</th>
                    <th colspan="3">Rincian Nilai</th>
                    <th rowspan="2" class="align-middle">Nilai Akhir</th>
                </tr>
                <tr>
                    <th>Rata-rata Harian</th>
                    <th>UTS</th>
                    <th>UAS</th>
                </tr>
            </thead>
            <tbody>
                {% if final_report %}
                    {% for item in final_report %}
                    <tr>
                        <td class="text-center">{{ loop.index }}</td>
                        <td class="fw-bold">{{ item.subject }}</td>
                        <td class="text-center">{{ item.harian }}</td>
                        <td class="text-center">{{ item.uts }}</td>
                        <td class="text-center">{{ item.uas }}</td>
                        <td class="text-center fw-bold bg-light">{{ item.final }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="6" class="text-center">Belum ada data nilai.</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>

        <div class="mt-3 small text-muted">
            <em>* Catatan: Nilai Akhir dihitung dari 30% Harian + 30% UTS + 40% UAS.</em>
        </div>
    </div>
</body>
</html>